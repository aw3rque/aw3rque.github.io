<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta charset="UTF-8">
        <meta name="theme-color" content="#000000">
        <title>efe#1234</title>
        <link rel = "icon" href = 
        "https://i.hizliresim.com/ryrpsc7.png" 
            type = "image/x-icon">
        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css">
        <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.14.0/css/all.css" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>

   </head>
    <body class="flex flex-col items-center mt-8 bg-gray-300">  
      <img src="02gif.gif" style="height: 92%; position: absolute;">
     <div class="relative  h-40 w-40">
        <div id="avatar" class="h-40 w-40  bg-gray-200 ring-4" style="margin-left: 263%">
        </div>
       <div id="status">
         </div>
      </div>
      <div class="flex flex-col mt-5 bg-gray-300">
    </div>
     <div class="bg-black w-x5 py-3 p-5 mt-4 text-white text-center max-w-2x2 space-y-5 shadow" style="z-index: 99; background: rgba(0, 0, 0, 0.63); margin-left: 40.8%; margin-top: -0.75%;">
         <h1 id="name" class="font-semibold text-2xl">downloading...</h1>
         
         <a href="https://instagram.com/efeeshu"><i class="fab fa-instagram"></i></a>

         <a href="https://github.com/aw3rque"><i class="fab fa-github"></i></a>

         <a href="https://www.twitch.tv/efeshu"><i class="fab fa-twitch"></i></a>

         <a href="https://open.spotify.com/user/3nwgygqzwengb9a6x5qyb9yn5?si=dbb726fc8dbe42ee"><i class="fab fa-spotify"></i></a>
         
         <a href="https://discord.com/users/280696584889696257"><i class="fab fa-discord"></i></a>
    </div>
   <div id="game" class="hidden max-w-sm flex flex-col justify-center items-center mt-5 py-5 p-10">

    <!--SPOTIFY--><div class="bg-black w-full flex items-center p-2 rounded-xl shadow" style="z-index: 3; background: rgba(0, 0, 0, 0.63); border-radius: 3px;">
      <div id="art" class="flex items-center space-x-4 md:py-5 md:p-5">  
    </div>

    <div class="flex-grow p-3 py-5 ml-auto">
      <div id="yazi" class="font-semibold text-white">
      </div>
      <div id="yazi2" class="text-sm text-gray-400">
        downloading...
      </div>
     <div id="album" class="text-sm text-gray-400">
      </div>            
      <div  class="text-sm text-green-400">
      </div>
    </div>
    <div id="album_art" class="p-3 py-5">
    </div>
  </div>
 </div>

   <script>
     let ws = new WebSocket('wss://api.lanyard.rest/socket');
     let Interval;

        ws.onopen = () => {
          ws.send(
            JSON.stringify({
              op: 2,
              d: {
                subscribe_to_id: "280696584889696257",
              },
            })
          );
    
          Interval = setInterval(() => {
            ws.send(
              JSON.stringify({
                op: 3,
              })
            );
          }, 3000);
        };
       ws.onmessage = (msg) => {
          msg = JSON.parse(msg.data);
          if (!['INIT_STATE', 'PRESENCE_UPDATE'].includes(msg.t)) return;
            let user = msg.d;
            $("#name").text(user.discord_user.username+"#"+user.discord_user.discriminator)
            $("#avatar").html(`<img src="https://cdn.discordapp.com/avatars/280696584889696257/${user.discord_user.avatar}.png" class="flex  h-40 w-40 mt-auto ml-auto">`)
            console.log(msg.d)
            console.log("şarkı, profil fotoğrafı veya durumu değişti.")
            console.log("sa")
           
            if(msg.d.discord_status === "online") {
             $("#avatar").addClass("ring-green-500")
            }
            if(msg.d.discord_status === "offline") {
             $("#avatar").addClass("ring-gray-500")
            }
            if(msg.d.discord_status === "dnd") {
             $("#avatar").addClass("ring-red-600")
            }
            if(msg.d.discord_status === "idle") {
             $("#avatar").addClass("ring-yellow-600")
            }
            
            if (msg.d.spotify.track_id) {
              $("#game").removeClass("hidden");
              $("#yazi").text(msg.d.spotify.song)
              $("#yazi2").text(msg.d.spotify.artist)
              $("#album").text(msg.d.spotify.album)
              $("#art").html(`<img class="w-16 h-16 rounded-lg" src="${msg.d.spotify.album_art_url}">`)
                
            } else {
              $("#game").addClass("hidden");  
            }
        };
        
    </script>
 </body>
</html>